name: Build Android APK with python-for-android

   on:
     push:
       branches:
         - main
     pull_request:
       branches:
         - main

   jobs:
     build:
       runs-on: ubuntu-latest

       steps:
       - name: Checkout code
         uses: actions/checkout@v4

       - name: Set up Python
         uses: actions/setup-python@v5
         with:
           python-version: "3.9"

       - name: Install system dependencies
         run: |
           sudo apt-get update
           sudo apt-get install -y python3-pip python3-setuptools python3-virtualenv
           sudo apt-get install -y openjdk-11-jdk
           sudo apt-get install -y wget unzip

       - name: Install python-for-android
         run: |
           pip install --upgrade pip
           pip install python-for-android

       - name: Build APK
         run: |
           p4a apk --private . --package=org.test.myapp --name=MyApp --version=1.0 --requirements=kivy --arch=armeabi-v7a

       - name: Upload APK Artifact
         uses: actions/upload-artifact@v4
         with:
           name: android-apk
           path: bin/*.apk
           if-no-files-found: error
